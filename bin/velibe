#!/usr/bin/env ruby
# -*- coding: utf-8 -*-
## My Velib Querrier

require 'velibe'

case ARGV[0]
  when /f(av(orite)?)?$/  # handle favorites
    stations = ARGV[2..-1] || []
    force = ARGV[2..-1].any? { |s| /-(f|-force)/ }

    case ARGV[1]
      when /a(dd)?/
        # TODO: check if all number
        Velibe.add_favorite(stations)
      when /setup|reset/
        if Velibe.reset_favorites(force)
          puts 'Favorites Stations were reset'
        else
          puts 'Favorites not empty, you need to add --force/-f flag if you really want to reset'
        end
      else
        Velibe.print_favorites
    end
  when /setup/
    force = ARGV[1] =~ /-(f|-force)/
    Velibe.setup_station_database(force)
    Velibe.reset_favorites(force)
  else
    # TODO: check if all number
    Velibe.print_stations(ARGV)
end